<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Speeding Up Scalar Multiplication Over Elliptic Curves | Prathamesh Dhake </title> <meta name="author" content="Prathamesh Dhake"> <meta name="description" content="My personal little website. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;P&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://i-9028.github.io/projects/4_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Prathamesh</span> Dhake </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/contact/">Contact </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Speeding Up Scalar Multiplication Over Elliptic Curves</h1> <p class="post-description"></p> </header> <article> <p>This project was a group project as a part of my course <strong>AE6102 Parallel Scientific Computing</strong> in my BTech at IIT Bombay in the academic year 2022-23, under the guidance of <strong>Prof. Prabhu Ramachandran</strong>.</p> <h2 id="introduction"><u><b>Introduction</b></u></h2> <p>Elliptic Curves form an important basis for existing encryption algorithms. It generates security between key pairs for public key encryption by using the mathematics of elliptic curves. All elliptic curve cryptography is based on the difficulty of finding a secret integer n given the scalar multiple <code class="language-plaintext highlighter-rouge">Q = [n]P = P + P + . . . + P</code> of a base point P on an elliptic curve, say E/k where k is the prime field.</p> <p>An example would be the curve <strong>Curve25519</strong> represented as \(y^2 = x^3 + 486662x^2 + x\)</p> <p>where k is the prime field <code class="language-plaintext highlighter-rouge">GF(2^{255} − 19)</code></p> <p>Scalar multiplication is an essential building block for public-key elliptic curve cryptography and has a significant influence on the execution time of ECC algorithms. Therefore, optimized scalar multiplication methods are vital for good ECC performance</p> <h2 id="outline"><b><u>Outline</u></b></h2> <p>The goal of this project was to optimize an elliptic curve-based scalar multiplication algorithm using an appropriate parallelization strategy. We aimed to accelerate elliptic curve scalar multiplication by parallelizing computations. However, our analysis of existing implementations<sup id="fnref:1"><a href="#fn:1" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> revealed that they relied on Python’s native <em>int</em> class or class-based structures, making them incompatible with parallelization using NumPy and Compyle.</p> <h2 id="methodologies"><u><b>Methodologies</b></u></h2> <p>We first designed a specialized data type using NumPy arrays, ensuring compatibility with Numba and Compyle for optimized performance.</p> <p>Given this limitation, we decided to develop a custom implementation designed for efficient parallel computation.</p> <p>After finalizing this data structure, we implemented fundamental elliptic curve algorithms, testing them rigorously to ensure correctness and benchmarking their performance across the five Weierstrass NIST P curves<sup id="fnref:3"><a href="#fn:3" class="footnote" rel="footnote" role="doc-noteref">2</a></sup> using the Automan<sup id="fnref:2"><a href="#fn:2" class="footnote" rel="footnote" role="doc-noteref">3</a></sup> package.</p> <p>Following this, we focused on implementing basic arithmetic functions, including division and the multiplicative inverse, which proved particularly challenging. We identified Python’s <em>divmod</em> function as a key component and worked on adapting it to be compatible with our data type. Successfully implementing this function would enable efficient computation of the multiplicative inverse, which is crucial for optimizing scalar multiplication algorithms.</p> <p>Finally, with this foundation, we aimed to measure the speedup achieved through parallelization, leveraging our custom array-based approach to improve performance over existing implementations.</p> <h2 id="theory"><u><b>Theory</b></u></h2> <h3 id="longnum"><b>LongNum</b></h3> <p>We implemented a custom data type to store numbers ranging from 192 bits (P-192 curve) to 521 bits (P-521 curve). This data type uses a <strong>32-element numpy array</strong> where each element is a 32-bit integer (<code class="language-plaintext highlighter-rouge">numpy.uint32</code>).</p> <h4 id="implementation-details"><u>Implementation Details</u></h4> <ul> <li>Located in the <code class="language-plaintext highlighter-rouge">arithmetic</code> folder of the <a href="https://github.com/ae6102-project" rel="external nofollow noopener" target="_blank">GitHub repository</a>.</li> <li>Example:<br> <code class="language-plaintext highlighter-rouge">bin(999904040455042) = '0b11100011010110100001001101001001000000101110000010'</code><br> Split into 32-bit chunks: <ul> <li> <code class="language-plaintext highlighter-rouge">'0b1001101001001000000101110000010'</code> → stored as <code class="language-plaintext highlighter-rouge">1294207874</code> </li> <li> <code class="language-plaintext highlighter-rouge">'0b111000110101101000'</code> → stored as <code class="language-plaintext highlighter-rouge">232808</code> </li> </ul> </li> </ul> <h4 id="performance-insights">Performance Insights</h4> <ul> <li>Built on numpy arrays for compatibility with <strong>numba</strong> and <strong>compyle</strong> acceleration.</li> <li>Parallelization benefits for operations like multiplication.</li> <li>Benchmark results (vs. native Python): <ul> <li> <strong>Addition/Subtraction</strong>: ~5× slower</li> <li> <strong>Multiplication</strong>: ~10× slower</li> <li> <strong>Divmod</strong>: Significantly slower → Optimized via <strong>scalene</strong> profiling.</li> </ul> </li> </ul> <hr> <h3 id="multiplicative-inverse">Multiplicative Inverse</h3> <p>We benchmarked three algorithms for inverse computation in GF(<em>p</em>):</p> <table> <thead> <tr> <th>Algorithm</th> <th>Complexity</th> </tr> </thead> <tbody> <tr> <td>Trivial</td> <td><em>O(p)</em></td> </tr> <tr> <td>Extended Euclidean Algorithm</td> <td><em>O(log p)</em></td> </tr> <tr> <td>Fermat’s Little Theorem</td> <td><em>O(log p)</em></td> </tr> </tbody> </table> <h3 id="automation-for-benchmarking"><b>Automation for Benchmarking</b></h3> <h4 id="algorithms-tested"><u>Algorithms Tested</u></h4> <ul> <li>Scalar multiplication methods: <ul> <li>Double-and-Add</li> <li>Montgomery Ladder</li> <li>Joye’s Double-and-Add (recursive)</li> </ul> </li> </ul> <h4 id="test-setup"><u>Test Setup</u></h4> <ol> <li> <strong>Basic Curve</strong>:<br> \(y^2 = x^3 + 2x + 2\)<br> Over GF(17) with generator point <em>(10, 6)</em>.</li> <li> <p><strong>NIST P-Curves</strong>:<br> Tested on P-192, P-224, P-256, and P-384 (parameters loaded via <code class="language-plaintext highlighter-rouge">json</code>, the parameters located as <em>json</em> files in the <em>curves/</em> folder in the Github repo).</p> <p>Structure of P-521 is as:</p> <div class="language-json highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"P-521"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"desc"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
     </span><span class="nl">"oid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.3.132.0.35"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"form"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Weierstrass"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Prime"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x01ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"bits"</span><span class="p">:</span><span class="w"> </span><span class="mi">521</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"a"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="nl">"raw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="nl">"b"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="nl">"raw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"</span><span class="w">
         </span><span class="p">}</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="nl">"generator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="nl">"raw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="nl">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="nl">"raw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"</span><span class="w">
         </span><span class="p">}</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="nl">"order"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"cofactor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x1"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"aliases"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
         </span><span class="s2">"secg/secp521r1"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"x963/ansip521r1"</span><span class="w">
     </span><span class="p">],</span><span class="w">
     </span><span class="nl">"characteristics"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"seed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"D09E8800291CB85396CC6717393284AAA0DA64BA"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"j_invariant"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3619090631887053412807272747807643016060282478111249168973675223587770705025281286979867546071268566958111997954788345609183745222693618155278831649044785613"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"discriminant"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2687853087729004331535582886185403114835754464152651523509230634031161977750238608042000458607319784141115468556368066113806987449553072575343372028907331922"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"trace_of_frobenius"</span><span class="p">:</span><span class="w"> </span><span class="s2">"657877501894328237357444332315020117536923257219387276263472201219398408051703"</span><span class="w">
     </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre></div> </div> </li> <li> <strong>Framework</strong>:<br> Automated 80+ test cases using <code class="language-plaintext highlighter-rouge">automan</code> python package<sup id="fnref:2:1"><a href="#fn:2" class="footnote" rel="footnote" role="doc-noteref">3</a></sup> to measure time for computing <em>kP</em> (scalar multiples of point <em>P</em>).</li> </ol> <h3 id="results"><b><u>Results</u></b></h3> <p>When we benchmarked <em>mulyiplicative inverse</em>, we found that Extended Euclidean Algorithm outperformed others and was selected for implementation.</p> <p>Time taken by various algorithms over various curves, first we note the effect on all the curves as we scale the value of the scalar <em>k</em>,</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/elliptic/Change_k_curves-480.webp 480w,/assets/img/elliptic/Change_k_curves-800.webp 800w,/assets/img/elliptic/Change_k_curves-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/elliptic/Change_k_curves.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Changes over various curves" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Now, showing the changes for every algorithm,</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/elliptic/Change_k_algos-480.webp 480w,/assets/img/elliptic/Change_k_algos-800.webp 800w,/assets/img/elliptic/Change_k_algos-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/elliptic/Change_k_algos.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Changes over various Algorithms" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Thus we see that the time taken by all the algorithms is larger as the number of bits in the elliptic curve field increases.</p> <h2 id="references"><u>References</u></h2> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:1"> <p>Gerwin Gsenger. (Year 2014). Speeding Up Elliptic Curve Cryptography by Optimizing Scalar Multiplication in Software Implementations. Unpublished master’s thesis, Graz University of Technology <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:3"> <p>P-192. Accessed May 3, 2023. https://neuromancer.sk/std/nist/P-192 <a href="#fnref:3" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:2"> <p>Prabhu Ramachandran, “automan: A Python-Based Automation Framework for Numerical Computing,” in Computing in Science I\&amp; Engineering, vol. 20, no. 5, pp. 81-97, 2018. doi:10.1109/MCSE.2018.05329818 <a href="#fnref:2" class="reversefootnote" role="doc-backlink">↩</a> <a href="#fnref:2:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p> </li> </ol> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Prathamesh Dhake. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. Last updated: April 03, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>